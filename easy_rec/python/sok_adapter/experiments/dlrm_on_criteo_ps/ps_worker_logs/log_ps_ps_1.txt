2022-05-10 10:37:57.784179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
[2022-05-10 10:37:59,019][INFO] GraphLearn is not installed. You can install it by "pip install https://easyrec.oss-cn-beijing.aliyuncs.com/3rdparty/graphlearn-0.7-cp27-cp27mu-linux_x86_64.whl"
[2022-05-10 10:37:59,077][INFO] Try importing sparse_operation_kit ...
[2022-05-10 10:37:59,086][ERROR] Traceback (most recent call last):
  File "/home/ruotongw/EasyRec/easy_rec/python/sok_adapter/__init__.py", line 19, in <module>
    sparse_operation_kit.Init
AttributeError: module 'sparse_operation_kit' has no attribute 'Init'

[2022-05-10 10:37:59,086][INFO] sparse_operation_kit module importing failed. Continue running the program,but anything related with SOK will not work properly
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:28: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

[2022-05-10 10:37:59,119][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:28: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:29: The name tf.train.CheckpointSaverHook is deprecated. Please use tf.estimator.CheckpointSaverHook instead.

[2022-05-10 10:37:59,119][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:29: The name tf.train.CheckpointSaverHook is deprecated. Please use tf.estimator.CheckpointSaverHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/feature_column/feature_column.py:19: The name tf.min_max_variable_partitioner is deprecated. Please use tf.compat.v1.min_max_variable_partitioner instead.

[2022-05-10 10:37:59,283][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/feature_column/feature_column.py:19: The name tf.min_max_variable_partitioner is deprecated. Please use tf.compat.v1.min_max_variable_partitioner instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:39: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

[2022-05-10 10:37:59,332][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/main.py:39: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:40: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

[2022-05-10 10:37:59,332][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/main.py:40: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/layers/layer_norm.py:9: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

[2022-05-10 10:37:59,876][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/layers/layer_norm.py:9: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

[2022-05-10 10:37:59,911][WARNING] 
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:TensorFlow will not use sklearn by default. This improves performance in some cases. To enable sklearn export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:37:59,962][WARNING] TensorFlow will not use sklearn by default. This improves performance in some cases. To enable sklearn export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:TensorFlow will not use Dask by default. This improves performance in some cases. To enable Dask export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:37:59,999][WARNING] TensorFlow will not use Dask by default. This improves performance in some cases. To enable Dask export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:TensorFlow will not use Pandas by default. This improves performance in some cases. To enable Pandas export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:38:00,003][WARNING] TensorFlow will not use Pandas by default. This improves performance in some cases. To enable Pandas export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:38:00,338][WARNING] DataHub is not installed. You can install it by: pip install pydatahub
[2022-05-10 10:38:00,344][WARNING] pyhive is not installed.
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/train_eval.py:148: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

[2022-05-10 10:38:00,384][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/train_eval.py:148: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:40: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0510 10:38:00.384460 140719172101952 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:40: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:45: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

W0510 10:38:00.384636 140719172101952 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:45: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

INFO:tensorflow:TF_CONFIG environment variable: {'cluster': {'ps': ['localhost:2227', 'localhost:2220'], 'chief': ['localhost:2225'], 'worker': ['localhost:2224', 'localhost:2222', 'localhost:2223', 'localhost:2226', 'localhost:2228', 'localhost:2221', 'localhost:2229']}, 'task': {'type': 'ps', 'index': 1}}
I0510 10:38:00.406893 140719172101952 run_config.py:535] TF_CONFIG environment variable: {'cluster': {'ps': ['localhost:2227', 'localhost:2220'], 'chief': ['localhost:2225'], 'worker': ['localhost:2224', 'localhost:2222', 'localhost:2223', 'localhost:2226', 'localhost:2228', 'localhost:2221', 'localhost:2229']}, 'task': {'type': 'ps', 'index': 1}}
INFO:tensorflow:Using config: {'_model_dir': 'experiments/dlrm_on_criteo_ps/ckpt', '_tf_random_seed': None, '_save_summary_steps': 1000, '_save_checkpoints_steps': 10000, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  allow_growth: true
}
allow_soft_placement: true
, '_keep_checkpoint_max': 10, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ffa192726a0>, '_task_type': 'ps', '_task_id': 1, '_evaluation_master': '', '_master': 'grpc://localhost:2220', '_num_ps_replicas': 2, '_num_worker_replicas': 8, '_global_id_in_cluster': 9, '_is_chief': False}
I0510 10:38:00.407361 140719172101952 estimator.py:212] Using config: {'_model_dir': 'experiments/dlrm_on_criteo_ps/ckpt', '_tf_random_seed': None, '_save_summary_steps': 1000, '_save_checkpoints_steps': 10000, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  allow_growth: true
}
allow_soft_placement: true
, '_keep_checkpoint_max': 10, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ffa192726a0>, '_task_type': 'ps', '_task_id': 1, '_evaluation_master': '', '_master': 'grpc://localhost:2220', '_num_ps_replicas': 2, '_num_worker_replicas': 8, '_global_id_in_cluster': 9, '_is_chief': False}
I0510 10:38:00.407736 140719172101952 input.py:37] check_mode: False 
I0510 10:38:00.418790 140719172101952 criteo_input.py:54] total number of input parts: 1
I0510 10:38:00.418870 140719172101952 criteo_binary_reader.py:34] total number samples = 89137319
I0510 10:38:00.418907 140719172101952 criteo_binary_reader.py:59] num_batches = 171 num_samples = 11142165
I0510 10:38:00.418936 140719172101952 criteo_binary_reader.py:70] start_file_id = 0 start_file_pos = 22284330
I0510 10:38:00.419128 140719172101952 criteo_binary_reader.py:97] end_file_id = 0 end_file_pos = 33426495
I0510 10:38:00.425985 140719172101952 input.py:37] check_mode: False 
I0510 10:38:00.426235 140719172101952 input.py:37] check_mode: False 
I0510 10:38:00.430522 140719172101952 criteo_input.py:54] total number of input parts: 1
I0510 10:38:00.430590 140719172101952 criteo_binary_reader.py:34] total number samples = 89137319
I0510 10:38:00.430626 140719172101952 criteo_binary_reader.py:59] num_batches = 171 num_samples = 11142165
I0510 10:38:00.430655 140719172101952 criteo_binary_reader.py:70] start_file_id = 0 start_file_pos = 22284330
I0510 10:38:00.430834 140719172101952 criteo_binary_reader.py:97] end_file_id = 0 end_file_pos = 33426495
INFO:tensorflow:Not using Distribute Coordinator.
I0510 10:38:00.436837 140719172101952 estimator_training.py:186] Not using Distribute Coordinator.
INFO:tensorflow:Start Tensorflow server.
I0510 10:38:00.437063 140719172101952 training.py:744] Start Tensorflow server.
2022-05-10 10:38:00.469582: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2700000000 Hz
2022-05-10 10:38:00.474330: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x3ae9ff0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-05-10 10:38:00.474348: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-05-10 10:38:00.476624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-05-10 10:38:01.827072: E tensorflow/stream_executor/cuda/cuda_driver.cc:282] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2022-05-10 10:38:01.827146: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: a6f30ef5717d
2022-05-10 10:38:01.827156: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: a6f30ef5717d
2022-05-10 10:38:01.827381: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 510.47.3
2022-05-10 10:38:01.827430: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 470.57.2
2022-05-10 10:38:01.827439: E tensorflow/stream_executor/cuda/cuda_diagnostics.cc:313] kernel version 470.57.2 does not match DSO version 510.47.3 -- cannot find working devices in this configuration
2022-05-10 10:38:01.829241: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:258] Initialize GrpcChannelCache for job chief -> {0 -> localhost:2225}
2022-05-10 10:38:01.829258: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:258] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2227, 1 -> localhost:2220}
2022-05-10 10:38:01.829263: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:258] Initialize GrpcChannelCache for job worker -> {0 -> localhost:2224, 1 -> localhost:2222, 2 -> localhost:2223, 3 -> localhost:2226, 4 -> localhost:2228, 5 -> localhost:2221, 6 -> localhost:2229}
2022-05-10 10:38:01.835924: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:365] Started server with target: grpc://localhost:2220
