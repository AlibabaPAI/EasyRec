2022-05-10 10:37:57.785538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
[2022-05-10 10:37:59,019][INFO] GraphLearn is not installed. You can install it by "pip install https://easyrec.oss-cn-beijing.aliyuncs.com/3rdparty/graphlearn-0.7-cp27-cp27mu-linux_x86_64.whl"
[2022-05-10 10:37:59,077][INFO] Try importing sparse_operation_kit ...
[2022-05-10 10:37:59,086][ERROR] Traceback (most recent call last):
  File "/home/ruotongw/EasyRec/easy_rec/python/sok_adapter/__init__.py", line 19, in <module>
    sparse_operation_kit.Init
AttributeError: module 'sparse_operation_kit' has no attribute 'Init'

[2022-05-10 10:37:59,086][INFO] sparse_operation_kit module importing failed. Continue running the program,but anything related with SOK will not work properly
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:28: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

[2022-05-10 10:37:59,119][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:28: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:29: The name tf.train.CheckpointSaverHook is deprecated. Please use tf.estimator.CheckpointSaverHook instead.

[2022-05-10 10:37:59,119][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:29: The name tf.train.CheckpointSaverHook is deprecated. Please use tf.estimator.CheckpointSaverHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/feature_column/feature_column.py:19: The name tf.min_max_variable_partitioner is deprecated. Please use tf.compat.v1.min_max_variable_partitioner instead.

[2022-05-10 10:37:59,283][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/feature_column/feature_column.py:19: The name tf.min_max_variable_partitioner is deprecated. Please use tf.compat.v1.min_max_variable_partitioner instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:39: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

[2022-05-10 10:37:59,332][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/main.py:39: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:40: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

[2022-05-10 10:37:59,332][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/main.py:40: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/layers/layer_norm.py:9: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

[2022-05-10 10:37:59,876][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/layers/layer_norm.py:9: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

[2022-05-10 10:37:59,911][WARNING] 
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:TensorFlow will not use sklearn by default. This improves performance in some cases. To enable sklearn export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:37:59,963][WARNING] TensorFlow will not use sklearn by default. This improves performance in some cases. To enable sklearn export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:TensorFlow will not use Dask by default. This improves performance in some cases. To enable Dask export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:37:59,999][WARNING] TensorFlow will not use Dask by default. This improves performance in some cases. To enable Dask export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:TensorFlow will not use Pandas by default. This improves performance in some cases. To enable Pandas export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:38:00,003][WARNING] TensorFlow will not use Pandas by default. This improves performance in some cases. To enable Pandas export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-10 10:38:00,338][WARNING] DataHub is not installed. You can install it by: pip install pydatahub
[2022-05-10 10:38:00,344][WARNING] pyhive is not installed.
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/train_eval.py:148: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

[2022-05-10 10:38:00,384][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/train_eval.py:148: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:40: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0510 10:38:00.384463 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:40: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:45: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

W0510 10:38:00.384636 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:45: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

INFO:tensorflow:TF_CONFIG environment variable: {'cluster': {'ps': ['localhost:2227', 'localhost:2220'], 'chief': ['localhost:2225'], 'worker': ['localhost:2224', 'localhost:2222', 'localhost:2223', 'localhost:2226', 'localhost:2228', 'localhost:2221', 'localhost:2229']}, 'task': {'type': 'chief', 'index': 0}}
I0510 10:38:00.407300 139720401168192 run_config.py:535] TF_CONFIG environment variable: {'cluster': {'ps': ['localhost:2227', 'localhost:2220'], 'chief': ['localhost:2225'], 'worker': ['localhost:2224', 'localhost:2222', 'localhost:2223', 'localhost:2226', 'localhost:2228', 'localhost:2221', 'localhost:2229']}, 'task': {'type': 'chief', 'index': 0}}
INFO:tensorflow:Using config: {'_model_dir': 'experiments/dlrm_on_criteo_ps/ckpt', '_tf_random_seed': None, '_save_summary_steps': 1000, '_save_checkpoints_steps': 10000, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  allow_growth: true
}
allow_soft_placement: true
, '_keep_checkpoint_max': 10, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f118dc1e6d0>, '_task_type': 'chief', '_task_id': 0, '_evaluation_master': '', '_master': 'grpc://localhost:2225', '_num_ps_replicas': 2, '_num_worker_replicas': 8, '_global_id_in_cluster': 0, '_is_chief': True}
I0510 10:38:00.407786 139720401168192 estimator.py:212] Using config: {'_model_dir': 'experiments/dlrm_on_criteo_ps/ckpt', '_tf_random_seed': None, '_save_summary_steps': 1000, '_save_checkpoints_steps': 10000, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  allow_growth: true
}
allow_soft_placement: true
, '_keep_checkpoint_max': 10, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f118dc1e6d0>, '_task_type': 'chief', '_task_id': 0, '_evaluation_master': '', '_master': 'grpc://localhost:2225', '_num_ps_replicas': 2, '_num_worker_replicas': 8, '_global_id_in_cluster': 0, '_is_chief': True}
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:202: The name tf.gfile.IsDirectory is deprecated. Please use tf.io.gfile.isdir instead.

W0510 10:38:00.408141 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/main.py:202: The name tf.gfile.IsDirectory is deprecated. Please use tf.io.gfile.isdir instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:205: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0510 10:38:00.408257 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/main.py:205: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:312: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

W0510 10:38:00.417677 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:312: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

I0510 10:38:00.417768 139720401168192 config_util.py:313] Writing protobuf message file to experiments/dlrm_on_criteo_ps/ckpt/pipeline.config
I0510 10:38:00.427924 139720401168192 input.py:37] check_mode: False 
I0510 10:38:00.433007 139720401168192 criteo_input.py:54] total number of input parts: 1
I0510 10:38:00.433082 139720401168192 criteo_binary_reader.py:34] total number samples = 89137319
I0510 10:38:00.433120 139720401168192 criteo_binary_reader.py:59] num_batches = 171 num_samples = 11142165
I0510 10:38:00.433149 139720401168192 criteo_binary_reader.py:70] start_file_id = 0 start_file_pos = 0
I0510 10:38:00.433312 139720401168192 criteo_binary_reader.py:97] end_file_id = 0 end_file_pos = 11142165
I0510 10:38:00.437022 139720401168192 input.py:37] check_mode: False 
I0510 10:38:00.437272 139720401168192 input.py:37] check_mode: False 
I0510 10:38:00.441787 139720401168192 criteo_input.py:54] total number of input parts: 1
I0510 10:38:00.441876 139720401168192 criteo_binary_reader.py:34] total number samples = 89137319
I0510 10:38:00.441914 139720401168192 criteo_binary_reader.py:59] num_batches = 171 num_samples = 11142165
I0510 10:38:00.441944 139720401168192 criteo_binary_reader.py:70] start_file_id = 0 start_file_pos = 0
I0510 10:38:00.442107 139720401168192 criteo_binary_reader.py:97] end_file_id = 0 end_file_pos = 11142165
INFO:tensorflow:Not using Distribute Coordinator.
I0510 10:38:00.446717 139720401168192 estimator_training.py:186] Not using Distribute Coordinator.
INFO:tensorflow:Start Tensorflow server.
I0510 10:38:00.446989 139720401168192 training.py:744] Start Tensorflow server.
2022-05-10 10:38:00.457602: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2700000000 Hz
2022-05-10 10:38:00.461532: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2d29aa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-05-10 10:38:00.461545: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-05-10 10:38:00.463622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-05-10 10:38:02.859832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2c36db0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-05-10 10:38:02.859866: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM3-32GB, Compute Capability 7.0
2022-05-10 10:38:02.864386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM3-32GB major: 7 minor: 0 memoryClockRate(GHz): 1.597
pciBusID: 0000:5e:00.0
2022-05-10 10:38:02.864418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-10 10:38:02.868596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-10 10:38:02.894143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-10 10:38:02.894463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-10 10:38:02.894976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-10 10:38:02.895887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-10 10:38:02.896064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-10 10:38:02.905055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0
2022-05-10 10:38:02.905083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-10 10:38:03.318754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-10 10:38:03.318787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 
2022-05-10 10:38:03.318792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N 
2022-05-10 10:38:03.324739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:chief/replica:0/task:0/device:GPU:0 with 31004 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM3-32GB, pci bus id: 0000:5e:00.0, compute capability: 7.0)
2022-05-10 10:38:03.327493: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:258] Initialize GrpcChannelCache for job chief -> {0 -> localhost:2225}
2022-05-10 10:38:03.327507: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:258] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2227, 1 -> localhost:2220}
2022-05-10 10:38:03.327512: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:258] Initialize GrpcChannelCache for job worker -> {0 -> localhost:2224, 1 -> localhost:2222, 2 -> localhost:2223, 3 -> localhost:2226, 4 -> localhost:2228, 5 -> localhost:2221, 6 -> localhost:2229}
2022-05-10 10:38:03.333618: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:365] Started server with target: grpc://localhost:2225
WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.string_to_number is deprecated. Please use tf.strings.to_number instead.

W0510 10:38:06.850596 139720401168192 module_wrapper.py:137] From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.string_to_number is deprecated. Please use tf.strings.to_number instead.

WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.assert_equal is deprecated. Please use tf.compat.v1.assert_equal instead.

W0510 10:38:06.852327 139720401168192 module_wrapper.py:137] From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.assert_equal is deprecated. Please use tf.compat.v1.assert_equal instead.

INFO:tensorflow:Calling model_fn.
I0510 10:38:13.948253 139720401168192 estimator.py:1148] Calling model_fn.
I0510 10:38:13.948874 139720401168192 feature_column.py:100] shared embeddings[num=1]
I0510 10:38:13.948940 139720401168192 feature_column.py:102] 	embedding: share_num[22], share_info[{'embedding_dim': 32, 'combiner': 'mean', 'initializer': None, 'max_partitions': 8}]
I0510 10:38:15.237281 139720401168192 dnn.py:28] dnn activation function = tf.nn.relu
I0510 10:38:15.328256 139720401168192 dlrm.py:41] arch_interaction_op = dot
I0510 10:38:15.462055 139720401168192 dnn.py:28] dnn activation function = tf.nn.relu
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/builders/loss_builder.py:19: The name tf.losses.sigmoid_cross_entropy is deprecated. Please use tf.compat.v1.losses.sigmoid_cross_entropy instead.

W0510 10:38:15.593033 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/builders/loss_builder.py:19: The name tf.losses.sigmoid_cross_entropy is deprecated. Please use tf.compat.v1.losses.sigmoid_cross_entropy instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:90: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

W0510 10:38:15.607180 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:90: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:91: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

W0510 10:38:15.607335 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:91: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:110: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0510 10:38:15.608325 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:110: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/builders/optimizer_builder.py:58: The name tf.train.MomentumOptimizer is deprecated. Please use tf.compat.v1.train.MomentumOptimizer instead.

W0510 10:38:15.611972 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/builders/optimizer_builder.py:58: The name tf.train.MomentumOptimizer is deprecated. Please use tf.compat.v1.train.MomentumOptimizer instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:223: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0510 10:38:15.612769 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:223: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:226: The name tf.train.get_global_step is deprecated. Please use tf.compat.v1.train.get_global_step instead.

W0510 10:38:15.612871 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:226: The name tf.train.get_global_step is deprecated. Please use tf.compat.v1.train.get_global_step instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:284: The name tf.train.LoggingTensorHook is deprecated. Please use tf.estimator.LoggingTensorHook instead.

W0510 10:38:18.034518 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:284: The name tf.train.LoggingTensorHook is deprecated. Please use tf.estimator.LoggingTensorHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:353: The name tf.train.Scaffold is deprecated. Please use tf.compat.v1.train.Scaffold instead.

W0510 10:38:18.034893 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:353: The name tf.train.Scaffold is deprecated. Please use tf.compat.v1.train.Scaffold instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:354: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

W0510 10:38:18.034979 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:354: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:359: The name tf.report_uninitialized_variables is deprecated. Please use tf.compat.v1.report_uninitialized_variables instead.

W0510 10:38:18.212856 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:359: The name tf.report_uninitialized_variables is deprecated. Please use tf.compat.v1.report_uninitialized_variables instead.

INFO:tensorflow:Create CheckpointSaverHook.
I0510 10:38:18.276313 139720401168192 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0510 10:38:18.276559 139720401168192 estimator.py:1150] Done calling model_fn.
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:54: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0510 10:38:19.230079 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:54: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:number workers(including master) = 8
I0510 10:38:19.230264 139720401168192 estimator_utils.py:54] number workers(including master) = 8
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:57: The name tf.FIFOQueue is deprecated. Please use tf.queue.FIFOQueue instead.

W0510 10:38:19.230475 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:57: The name tf.FIFOQueue is deprecated. Please use tf.queue.FIFOQueue instead.

INFO:tensorflow:Graph was finalized.
I0510 10:38:19.304506 139720401168192 monitored_session.py:240] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0510 10:39:24.000453 139720401168192 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0510 10:39:24.181112 139720401168192 session_manager.py:502] Done running local_init_op.
I0510 10:39:25.484568 139720401168192 estimator_utils.py:91] exit counter cleared: 0
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:314: The name tf.train.write_graph is deprecated. Please use tf.io.write_graph instead.

W0510 10:39:25.730664 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:314: The name tf.train.write_graph is deprecated. Please use tf.io.write_graph instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:314: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0510 10:39:25.730840 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:314: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

I0510 10:39:28.814978 139720401168192 estimator_utils.py:334] Saving checkpoints for 0 into experiments/dlrm_on_criteo_ps/ckpt/model.ckpt.
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:347: The name tf.SessionLog is deprecated. Please use tf.compat.v1.SessionLog instead.

W0510 10:45:10.686444 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:347: The name tf.SessionLog is deprecated. Please use tf.compat.v1.SessionLog instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:330: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs instead.

W0510 10:45:10.773241 139720401168192 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:330: The name tf.train.SessionRunArgs is deprecated. Please use tf.estimator.SessionRunArgs instead.

2022-05-10 10:45:18.988533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
I0510 10:45:20.193241 139690363569920 criteo_input.py:70] start epoch: 0
2022-05-10 10:45:22.518427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
INFO:tensorflow:loss = 0.13880338, step = 7380
I0510 10:45:41.432797 139720401168192 basic_session_run_hooks.py:262] loss = 0.13880338, step = 7380
INFO:tensorflow:lr = 1e-04,step = 7380,cross_entropy_loss = 0.13238516,regularization_loss = 0.006418207,total_loss = 0.13880338
I0510 10:45:41.433699 139720401168192 basic_session_run_hooks.py:254] lr = 1e-04,step = 7380,cross_entropy_loss = 0.13238516,regularization_loss = 0.006418207,total_loss = 0.13880338
INFO:tensorflow:global_step/sec: 25.3424
I0510 10:45:52.869313 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 25.3424
INFO:tensorflow:global_step/sec: 26.048
I0510 10:45:57.130592 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 26.048
INFO:tensorflow:global_step/sec: 25.3683
I0510 10:46:01.427123 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 25.3683
INFO:tensorflow:global_step/sec: 26.5435
I0510 10:46:05.534184 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 26.5435
INFO:tensorflow:global_step/sec: 26.9963
I0510 10:46:09.719385 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 26.9963
INFO:tensorflow:global_step/sec: 25.6215
I0510 10:46:13.895479 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 25.6215
INFO:tensorflow:global_step/sec: 27.421
I0510 10:46:17.980092 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 27.421
INFO:tensorflow:global_step/sec: 25.5116
I0510 10:46:31.503354 139720401168192 basic_session_run_hooks.py:692] global_step/sec: 25.5116
I0510 10:46:33.011049 139688560023296 criteo_input.py:73] finish epoch: 0
I0510 10:46:33.033753 139688560023296 criteo_input.py:70] start epoch: 1
