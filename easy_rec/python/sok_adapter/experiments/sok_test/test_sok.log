2022-05-06 08:45:31.670689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
[2022-05-06 08:45:32,712][INFO] GraphLearn is not installed. You can install it by "pip install https://easyrec.oss-cn-beijing.aliyuncs.com/3rdparty/graphlearn-0.7-cp27-cp27mu-linux_x86_64.whl"
[2022-05-06 08:45:32,748][INFO] Try importing sparse_operation_kit ...
2022-05-06 08:45:32.759547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:TensorFlow will not use sklearn by default. This improves performance in some cases. To enable sklearn export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-06 08:45:32,818][WARNING] TensorFlow will not use sklearn by default. This improves performance in some cases. To enable sklearn export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:TensorFlow will not use Dask by default. This improves performance in some cases. To enable Dask export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-06 08:45:32,853][WARNING] TensorFlow will not use Dask by default. This improves performance in some cases. To enable Dask export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:TensorFlow will not use Pandas by default. This improves performance in some cases. To enable Pandas export the environment variable  TF_ALLOW_IOLIBS=1.
[2022-05-06 08:45:32,857][WARNING] TensorFlow will not use Pandas by default. This improves performance in some cases. To enable Pandas export the environment variable  TF_ALLOW_IOLIBS=1.
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:28: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

[2022-05-06 08:45:33,098][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:28: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:29: The name tf.train.CheckpointSaverHook is deprecated. Please use tf.estimator.CheckpointSaverHook instead.

[2022-05-06 08:45:33,098][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/utils/estimator_utils.py:29: The name tf.train.CheckpointSaverHook is deprecated. Please use tf.estimator.CheckpointSaverHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/feature_column/feature_column.py:19: The name tf.min_max_variable_partitioner is deprecated. Please use tf.compat.v1.min_max_variable_partitioner instead.

[2022-05-06 08:45:33,147][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/feature_column/feature_column.py:19: The name tf.min_max_variable_partitioner is deprecated. Please use tf.compat.v1.min_max_variable_partitioner instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:39: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

[2022-05-06 08:45:33,178][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/main.py:39: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:40: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

[2022-05-06 08:45:33,178][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/main.py:40: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/layers/layer_norm.py:9: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

[2022-05-06 08:45:33,568][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/layers/layer_norm.py:9: The name tf.layers.Layer is deprecated. Please use tf.compat.v1.layers.Layer instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

[2022-05-06 08:45:33,591][WARNING] 
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

[2022-05-06 08:45:33,603][WARNING] DataHub is not installed. You can install it by: pip install pydatahub
[2022-05-06 08:45:33,609][WARNING] pyhive is not installed.
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/train_eval.py:147: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

[2022-05-06 08:45:33,700][WARNING] From /home/ruotongw/EasyRec/easy_rec/python/train_eval.py:147: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:40: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0506 08:45:33.701449 140594446161728 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:40: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:45: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

W0506 08:45:33.701684 140594446161728 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:45: The name tf.gfile.GFile is deprecated. Please use tf.io.gfile.GFile instead.

W0506 08:45:33.710649 140594446161728 main.py:282] will set sync_replicas to False, because train_distribute[2] != NoStrategy
2022-05-06 08:45:33.711994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-05-06 08:45:33.810445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:33.811259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:33.811276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:33.815784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:33.842601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:33.842882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:33.843425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:33.844319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:33.844469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:33.847548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:33.861583: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2194900000 Hz
2022-05-06 08:45:33.865780: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5bc4690 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-05-06 08:45:33.865803: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-05-06 08:45:34.119182: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5a0e290 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-05-06 08:45:34.119206: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-05-06 08:45:34.119209: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-05-06 08:45:34.120838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:34.121611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:34.121635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:34.121668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:34.121679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:34.121687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:34.121696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:34.121704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:34.121714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:34.124719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:34.747988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:34.748026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:34.748031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:34.748034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:34.751442: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-05-06 08:45:34.751481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:34.753301: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-05-06 08:45:34.753324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:34.761930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:34.762714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:34.762746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:34.762789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:34.762803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:34.762813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:34.762822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:34.762832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:34.762843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:34.765856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:34.765876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:34.765881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:34.765884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:34.765886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:34.768207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:34.769092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
INFO:tensorflow:Initializing RunConfig with distribution strategies.
I0506 08:45:34.781062 140594446161728 run_config.py:566] Initializing RunConfig with distribution strategies.
INFO:tensorflow:Not using Distribute Coordinator.
I0506 08:45:34.781573 140594446161728 estimator_training.py:167] Not using Distribute Coordinator.
INFO:tensorflow:Using config: {'_model_dir': 'experiments/dlrm/taobao_ckpt', '_tf_random_seed': None, '_save_summary_steps': 1000, '_save_checkpoints_steps': 100, '_save_checkpoints_secs': None, '_session_config': device_filters: "/job:ps"
gpu_options {
}
allow_soft_placement: true
, '_keep_checkpoint_max': 10, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 10, '_train_distribute': <tensorflow.python.distribute.mirrored_strategy.MirroredStrategyV1 object at 0x7fdd001d03d0>, '_device_fn': None, '_protocol': None, '_eval_distribute': <tensorflow.python.distribute.mirrored_strategy.MirroredStrategyV1 object at 0x7fdd001d03d0>, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fdd001d07f0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1, '_distribute_coordinator_mode': None}
I0506 08:45:34.782096 140594446161728 estimator.py:212] Using config: {'_model_dir': 'experiments/dlrm/taobao_ckpt', '_tf_random_seed': None, '_save_summary_steps': 1000, '_save_checkpoints_steps': 100, '_save_checkpoints_secs': None, '_session_config': device_filters: "/job:ps"
gpu_options {
}
allow_soft_placement: true
, '_keep_checkpoint_max': 10, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 10, '_train_distribute': <tensorflow.python.distribute.mirrored_strategy.MirroredStrategyV1 object at 0x7fdd001d03d0>, '_device_fn': None, '_protocol': None, '_eval_distribute': <tensorflow.python.distribute.mirrored_strategy.MirroredStrategyV1 object at 0x7fdd001d03d0>, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fdd001d07f0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1, '_distribute_coordinator_mode': None}
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:199: The name tf.gfile.IsDirectory is deprecated. Please use tf.io.gfile.isdir instead.

W0506 08:45:34.782845 140594446161728 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/main.py:199: The name tf.gfile.IsDirectory is deprecated. Please use tf.io.gfile.isdir instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/main.py:202: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

W0506 08:45:34.783001 140594446161728 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/main.py:202: The name tf.gfile.Glob is deprecated. Please use tf.io.gfile.glob instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:312: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

W0506 08:45:34.787707 140594446161728 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/utils/config_util.py:312: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

I0506 08:45:34.787814 140594446161728 config_util.py:313] Writing protobuf message file to experiments/dlrm/taobao_ckpt/pipeline.config
I0506 08:45:34.797834 140594446161728 main.py:309] train_steps = 2500
INFO:tensorflow:Not using Distribute Coordinator.
I0506 08:45:34.816104 140594446161728 estimator_training.py:186] Not using Distribute Coordinator.
INFO:tensorflow:Running training and evaluation locally (non-distributed).
I0506 08:45:34.816317 140594446161728 training.py:612] Running training and evaluation locally (non-distributed).
INFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps 100 or save_checkpoints_secs None.
I0506 08:45:34.816625 140594446161728 training.py:695] Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps 100 or save_checkpoints_secs None.
I0506 08:45:34.828489 140594446161728 csv_input.py:93] train files[1]: data/test/tb_data/taobao_train_data
WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.decode_csv is deprecated. Please use tf.io.decode_csv instead.

W0506 08:45:34.969678 140594446161728 module_wrapper.py:137] From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.decode_csv is deprecated. Please use tf.io.decode_csv instead.

WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.string_to_number is deprecated. Please use tf.strings.to_number instead.

W0506 08:45:38.138479 140594446161728 module_wrapper.py:137] From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.string_to_number is deprecated. Please use tf.strings.to_number instead.

WARNING:tensorflow:From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.assert_equal is deprecated. Please use tf.compat.v1.assert_equal instead.

W0506 08:45:38.139872 140594446161728 module_wrapper.py:137] From /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.assert_equal is deprecated. Please use tf.compat.v1.assert_equal instead.

I0506 08:45:43.937834 140594446161728 __init__.py:34] Modifying <tensorflow.python.keras.optimizer_v2.gradient_descent.SGD object at 0x7fdcec56f040> 's apply_gradients
INFO:tensorflow:Calling model_fn.
I0506 08:45:43.939712 140564926285568 estimator.py:1148] Calling model_fn.
I0506 08:45:43.940375 140564926285568 feature_column.py:99] shared embeddings[num=0]
2022-05-06 08:45:43.942266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:43.943056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:43.943079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:43.943160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:43.943174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:43.943183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:43.943193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:43.943202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:43.943212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:43.946267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:43.946335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:43.946341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:43.946345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:43.946348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:43.948711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:43.949597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/layers/input_layer.py:384: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

W0506 08:45:43.997464 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/layers/input_layer.py:384: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

I0506 08:45:44.705899 140564926285568 dnn.py:28] dnn activation function = tf.nn.relu
I0506 08:45:44.872086 140564926285568 dlrm.py:41] arch_interaction_op = dot
I0506 08:45:44.940868 140564926285568 dnn.py:28] dnn activation function = tf.nn.relu
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/builders/loss_builder.py:17: The name tf.losses.sigmoid_cross_entropy is deprecated. Please use tf.compat.v1.losses.sigmoid_cross_entropy instead.

W0506 08:45:45.075745 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/builders/loss_builder.py:17: The name tf.losses.sigmoid_cross_entropy is deprecated. Please use tf.compat.v1.losses.sigmoid_cross_entropy instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:91: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

W0506 08:45:45.152428 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:91: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:110: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0506 08:45:45.153577 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:110: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/builders/optimizer_builder.py:159: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

W0506 08:45:45.156639 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/builders/optimizer_builder.py:159: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/core/learning_schedules.py:62: The name tf.train.exponential_decay is deprecated. Please use tf.compat.v1.train.exponential_decay instead.

W0506 08:45:45.156789 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/core/learning_schedules.py:62: The name tf.train.exponential_decay is deprecated. Please use tf.compat.v1.train.exponential_decay instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/builders/optimizer_builder.py:65: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

W0506 08:45:45.163930 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/builders/optimizer_builder.py:65: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:223: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0506 08:45:45.164872 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:223: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:226: The name tf.train.get_global_step is deprecated. Please use tf.compat.v1.train.get_global_step instead.

W0506 08:45:45.164990 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:226: The name tf.train.get_global_step is deprecated. Please use tf.compat.v1.train.get_global_step instead.

INFO:tensorflow:Calling model_fn.
I0506 08:45:45.390696 140564473308928 estimator.py:1148] Calling model_fn.
I0506 08:45:45.390991 140564473308928 feature_column.py:99] shared embeddings[num=0]
2022-05-06 08:45:45.392788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:45.393569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:45.393595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:45.393627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:45.393639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:45.393649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:45.393665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:45.393677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:45.393689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:45.396646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:45.396694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:45.396700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:45.396703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:45.396706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:45.399040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:45.399939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
I0506 08:45:45.508502 140564473308928 dnn.py:28] dnn activation function = tf.nn.relu
I0506 08:45:45.575989 140564473308928 dlrm.py:41] arch_interaction_op = dot
I0506 08:45:45.644819 140564473308928 dnn.py:28] dnn activation function = tf.nn.relu
INFO:tensorflow:batch_all_reduce: 22 all-reduces with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10
I0506 08:45:46.421896 140594446161728 cross_device_ops.py:743] batch_all_reduce: 22 all-reduces with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10
WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:283: The name tf.train.LoggingTensorHook is deprecated. Please use tf.estimator.LoggingTensorHook instead.

W0506 08:45:47.070639 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:283: The name tf.train.LoggingTensorHook is deprecated. Please use tf.estimator.LoggingTensorHook instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:307: The name tf.train.Scaffold is deprecated. Please use tf.compat.v1.train.Scaffold instead.

W0506 08:45:47.070907 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:307: The name tf.train.Scaffold is deprecated. Please use tf.compat.v1.train.Scaffold instead.

WARNING:tensorflow:From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:312: The name tf.report_uninitialized_variables is deprecated. Please use tf.compat.v1.report_uninitialized_variables instead.

W0506 08:45:47.071012 140564926285568 module_wrapper.py:137] From /home/ruotongw/EasyRec/easy_rec/python/model/easy_rec_estimator.py:312: The name tf.report_uninitialized_variables is deprecated. Please use tf.compat.v1.report_uninitialized_variables instead.

INFO:tensorflow:Done calling model_fn.
I0506 08:45:47.229441 140564926285568 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Done calling model_fn.
I0506 08:45:47.386385 140564473308928 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:47.386846 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Create CheckpointSaverHook.
I0506 08:45:47.396426 140594446161728 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
WARNING:tensorflow:Issue encountered when serializing variables.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
EmbeddingVariable.to_proto is not implemented
W0506 08:45:47.800534 140594446161728 meta_graph.py:445] Issue encountered when serializing variables.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
EmbeddingVariable.to_proto is not implemented
WARNING:tensorflow:Issue encountered when serializing trainable_variables.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
EmbeddingVariable.to_proto is not implemented
W0506 08:45:47.800760 140594446161728 meta_graph.py:445] Issue encountered when serializing trainable_variables.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
EmbeddingVariable.to_proto is not implemented
WARNING:tensorflow:Issue encountered when serializing SparseOperationKitEmbeddingLayers.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
'SparseEmbeddingLayerHandle' object has no attribute 'name'
W0506 08:45:47.800931 140594446161728 meta_graph.py:445] Issue encountered when serializing SparseOperationKitEmbeddingLayers.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
'SparseEmbeddingLayerHandle' object has no attribute 'name'
WARNING:tensorflow:Issue encountered when serializing SOK.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
'tuple' object has no attribute 'name'
W0506 08:45:47.801038 140594446161728 meta_graph.py:445] Issue encountered when serializing SOK.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
'tuple' object has no attribute 'name'
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:47.976643 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:47.979309 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:47.994585 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:47.997120 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:48.012597 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:48.015150 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:48.037918 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:48.040474 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
I0506 08:45:48.055844 140594446161728 cross_device_ops.py:425] Reduce to /replica:0/task:0/device:CPU:0 then broadcast to ('/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Graph was finalized.
I0506 08:45:48.360287 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:48.361654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:48.362443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:48.362469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:48.362500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:48.362510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:48.362519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:48.362529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:48.362538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:48.362547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:48.365503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:48.365547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:48.365552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:48.365556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:48.365558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:48.367958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:48.368862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:48.826748: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:48] ==========================

2022-05-06 08:45:48.826748: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:49] resource_mgr_->get_local_gpu_count(): 0
2022-05-06 08:45:48.826748: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable/replica_1
2022-05-06 08:45:48.826748: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:48.826748: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 1emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:49.715630 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:49.739772 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:49.741400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:49.742463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:49.743695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:49.743748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:49.743766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:49.743780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:49.743795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:49.743809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:49.743839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:49.747218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:49.747254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:49.747260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:49.747264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:49.747266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:49.749883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:49.750978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:50.093420 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:50.110322 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:50.111700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:50.112486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:50.112510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:50.112542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:50.112552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:50.112561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:50.112570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:50.112579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:50.112595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:50.115644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:50.115672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:50.115677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:50.115681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:50.115683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:50.118017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:50.118939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:50.456367 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:50.473783 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:50.475293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:50.476089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:50.476113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:50.476144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:50.476155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:50.476164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:50.476173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:50.476182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:50.476191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:50.479213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:50.479241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:50.479245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:50.479249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:50.479251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:50.481552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:50.482491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:50.826750: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:50.816956 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:50.834049 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:50.835461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:50.836243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:50.836267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:50.836296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:50.836307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:50.836317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:50.836327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:50.836336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:50.836346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:50.839405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:50.839434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:50.839438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:50.839442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:50.839444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:50.841755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:50.842711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:51.178586 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:51.195652 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:51.197034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:51.197808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:51.197832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:51.197861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:51.197872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:51.197881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:51.197891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:51.197899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:51.197909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:51.200948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:51.200980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:51.200985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:51.200989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:51.200991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:51.203343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:51.204237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:51.539081 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:51.555954 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:51.557364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:51.558206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:51.558251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:51.558300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:51.558311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:51.558320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:51.558329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:51.558338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:51.558347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:51.561320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:51.561347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:51.561352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:51.561355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:51.561358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:51.563726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:51.564571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:51.826751: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:51.901003 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:51.918439 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:51.919849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:51.920637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:51.920664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:51.920701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:51.920713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:51.920724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:51.920734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:51.920745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:51.920756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:51.923766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:51.923795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:51.923800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:51.923803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:51.923806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:51.926131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:51.927024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:52.264981 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:52.281985 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:52.283413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:52.284192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:52.284217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:52.284260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:52.284273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:52.284284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:52.284295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:52.284305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:52.284316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:52.287336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:52.287364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:52.287369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:52.287372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:52.287375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:52.289679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:52.290606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:52.623644 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:52.640644 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:52.642063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:52.642881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:52.642905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:52.642935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:52.642952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:52.642962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:52.642971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:52.642980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:52.642989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:52.645973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:52.646002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:52.646007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:52.646011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:52.646014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:52.648341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:52.649224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:52.826752: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[bot_dnn/dnn_2/kernel/Initializer/random_uniform/_15]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:52.987593 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[bot_dnn/dnn_2/kernel/Initializer/random_uniform/_15]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:53.004623 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:53.006028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:53.006908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:53.006933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:53.006965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:53.006975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:53.006984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:53.006993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:53.007002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:53.007012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:53.009982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:53.010011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:53.010016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:53.010020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:53.010022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:53.012372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:53.013256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:53.826753: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:53.826753: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:53.826753: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:53.348159 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:53.364886 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:53.366355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:53.367132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:53.367155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:53.367186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:53.367196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:53.367205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:53.367214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:53.367223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:53.367232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:53.370225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:53.370274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:53.370279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:53.370283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:53.370285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:53.372588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:53.373481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:53.826753: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:53.826753: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:53.826753: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:53.708172 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:53.725903 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:53.727347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:53.728121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:53.728149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:53.728181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:53.728191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:53.728200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:53.728209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:53.728218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:53.728227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:53.731243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:53.731271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:53.731276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:53.731279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:53.731282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:53.733594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:53.734552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:54.071075 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:54.088137 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:54.089535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:54.090397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:54.090425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:54.090462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:54.090474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:54.090485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:54.090496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:54.090507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:54.090518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:54.093463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:54.093490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:54.093495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:54.093498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:54.093501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:54.095867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:54.096749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:54.434481 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:122 errors happens due to /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/facade.cc:139 /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:157 local_replica_id is out of the range of emb_table_tensors.size().
	 [[node EmbeddingVariable/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:54.451895 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:54.453385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:54.454196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:54.454252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:54.454338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:54.454351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:54.454362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:54.454373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:54.454384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:54.454394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:54.457378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:54.457406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:54.457415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:54.457419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:54.457422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:54.459809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:54.460727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:54.826754: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:54.796454 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:54.813393 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:54.814854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:54.815636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:54.815665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:54.815695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:54.815705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:54.815714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:54.815723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:54.815732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:54.815741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:54.818766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:54.818793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:54.818798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:54.818801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:54.818804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:54.821159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:54.822068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:55.158746 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:55.175456 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:55.176865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:55.177643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:55.177666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:55.177696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:55.177707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:55.177716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:55.177724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:55.177733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:55.177742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:55.180797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:55.180825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:55.180830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:55.180833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:55.180836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:55.183254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:55.184139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:55.518162 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:55.535868 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:55.537267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:55.538106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:55.538132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:55.538163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:55.538174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:55.538184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:55.538193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:55.538203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:55.538213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:55.541212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:55.541240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:55.541245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:55.541249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:55.541251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:55.543687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:55.544536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:55.826755: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:55.881480 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:55.898581 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:55.899990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:55.900765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:55.900790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:55.900820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:55.900831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:55.900846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:55.900855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:55.900865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:55.900874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:55.903963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:55.903993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:55.903998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:55.904001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:55.904004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:55.906347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:55.907235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:56.241934 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:56.258882 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:56.260270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:56.261044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:56.261071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:56.261108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:56.261121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:56.261131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:56.261142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:56.261153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:56.261164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:56.264271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:56.264299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:56.264303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:56.264307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:56.264310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:56.266706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:56.267684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

INFO:tensorflow:An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

I0506 08:45:56.605715 140594446161728 monitored_session.py:1214] An error was raised while a session was being created. This may be due to a preemption of a connected worker or parameter server. A new session will be created. This error may also occur due to a gRPC failure caused by high memory or network bandwidth usage in the parameter servers. If this error occurs repeatedly, try increasing the number of parameter servers assigned to the job. Error: 2 root error(s) found.
  (0) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Aborted: /home/ruotongw/EasyRec/sparse_operation_kit/kit_cc/framework/kernels/assign_embedding_variable_op.cc:89 there already exist EmbeddingVariable/replica_1
	 [[node EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable (defined at /usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[GroupCrossDeviceControlEdges_0/group_deps_88/_18]]
1 successful operations.
0 derived errors ignored.

Original stack trace for 'EmbeddingVariable/replica_1/IsInitialized/AssignEmbeddingVariable':
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1300, in _actual_train_model_distributed
    sok_instance = sok.DistributedEmbedding(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/embeddings/distributed_embedding.py", line 110, in __init__
    self.var = EmbeddingVariable.CreateInstances(
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 61, in CreateInstances
    v = EmbeddingVariable(local_replica_id=i, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/ops/variables.py", line 262, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/sparse_operation_kit/core/embedding_variable_v1.py", line 138, in __init__
    _init_op = kit_lib.assign_embedding_variable(emb_var_handle=self.m_handle,
  File "<string>", line 104, in assign_embedding_variable
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/op_def_library.py", line 792, in _apply_op_helper
    op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/util/deprecation.py", line 513, in new_func
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3356, in create_op
    return self._create_op_internal(op_type, inputs, dtypes, input_types, name,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 3418, in _create_op_internal
    ret = Operation(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

INFO:tensorflow:Graph was finalized.
I0506 08:45:56.623103 140594446161728 monitored_session.py:240] Graph was finalized.
2022-05-06 08:45:56.624532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 0 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:06:00.0
2022-05-06 08:45:56.625325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1666] Found device 1 with properties: 
name: Tesla V100-SXM2-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.53
pciBusID: 0000:07:00.0
2022-05-06 08:45:56.625349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2022-05-06 08:45:56.625378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2022-05-06 08:45:56.625389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-05-06 08:45:56.625398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-05-06 08:45:56.625407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2022-05-06 08:45:56.625416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2022-05-06 08:45:56.625425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2022-05-06 08:45:56.628462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1794] Adding visible gpu devices: 0, 1
2022-05-06 08:45:56.628489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-05-06 08:45:56.628494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 
2022-05-06 08:45:56.628497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y 
2022-05-06 08:45:56.628500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N 
2022-05-06 08:45:56.630849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14653 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:06:00.0, compute capability: 7.0)
2022-05-06 08:45:56.631705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 14653 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:07:00.0, compute capability: 7.0)
2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_manager.cc:132] Created embedding variable whose name is EmbeddingVariable
2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:155] ==========================

2022-05-06 08:45:56.826756: I sparse_operation_kit/kit_cc/kit_cc_infra/src/parameters/raw_param.cc:156] local_replica_id: 0emb_table_tensors_.size(): 0

Traceback (most recent call last):
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 147, in <module>
    tf.app.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.8/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/home/ruotongw/EasyRec/easy_rec/python/train_eval.py", line 141, in main
    _train_and_evaluate_impl(pipeline_config, FLAGS.continue_train)
  File "/home/ruotongw/EasyRec/easy_rec/python/main.py", line 324, in _train_and_evaluate_impl
    estimator_train.train_and_evaluate(estimator, train_spec, eval_spec)
  File "/home/ruotongw/EasyRec/easy_rec/python/compat/estimator_train.py", line 83, in train_and_evaluate
    result = executor.run()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 613, in run
    return self.run_local()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/training.py", line 710, in run_local
    self._estimator.train(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1159, in _train_model
    return self._train_model_distributed(input_fn, hooks, saving_listeners)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1221, in _train_model_distributed
    return self._actual_train_model_distributed(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1348, in _actual_train_model_distributed
    return self._train_with_estimator_spec(estimator_spec, worker_hooks,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_estimator/python/estimator/estimator.py", line 1495, in _train_with_estimator_spec
    with training.MonitoredTrainingSession(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 581, in MonitoredTrainingSession
    return MonitoredSession(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 1010, in __init__
    super(MonitoredSession, self).__init__(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 725, in __init__
    self._sess = _RecoverableSession(self._coordinated_creator)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 1207, in __init__
    _WrappedSession.__init__(self, self._create_session())
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 1212, in _create_session
    return self._sess_creator.create_session()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 878, in create_session
    self.tf_sess = self._session_creator.create_session()
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/monitored_session.py", line 639, in create_session
    return self._get_session_manager().prepare_session(
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/training/session_manager.py", line 296, in prepare_session
    sess.run(init_op, feed_dict=init_feed_dict)
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/client/session.py", line 955, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/client/session.py", line 1179, in _run
    results = self._do_run(handle, final_targets, final_fetches,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/client/session.py", line 1358, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
  File "/usr/local/lib/python3.8/dist-packages/tensorflow_core/python/framework/errors_impl.py", line 401, in __init__
    def __init__(self, node_def, op, message):
KeyboardInterrupt
[INFO]: sparse_operation_kit is imported
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!
easy_rec version: 0.4.2
Usage: easy_rec.help()
[input] all feature names: ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
Compute grad!!!
Compute grad!!!
