model_dir: "experiments/graph_on_ultargcn_ckpt"

graph_train_input_path {
  user_node_input: "easy_rec/data/graph_data/gl_user.txt"
  item_node_input: "easy_rec/data/graph_data/gl_item.txt"
  u2i_edge_input: "easy_rec/data/graph_data/gl_train.txt"
  i2i_edge_input: "easy_rec/data/graph_data/gl_i2i.txt"
}
graph_eval_input_path {
  user_node_input: "easy_rec/data/graph_data/gl_user.txt"
  item_node_input: "easy_rec/data/graph_data/gl_item.txt"
  u2i_edge_input: "easy_rec/data/graph_data/gl_train.txt"
  i2i_edge_input: "easy_rec/data/graph_data/gl_i2i.txt"
}

train_config {
  log_step_count_steps: 100
  optimizer_config: {
    adam_optimizer: {
      learning_rate: {
        constant_learning_rate {
          learning_rate: 1e-3
        }
      }
    }
    use_moving_average: false
  }
  save_checkpoints_steps: 2000
  save_summary_steps: 100
  sync_replicas: true
  num_steps: 20000
}

eval_config {
}

data_config { 
  input_fields {
    input_name: 'id'
    input_type: INT64
  }
  ultra_gcn_sampler {
    nbr_num: 10
    neg_num: 10
    neg_sampler: 'random'
  }

  batch_size: 512
  num_epochs: 10
  prefetch_size: 5
  input_type: GraphInput
}

feature_config: {
  features: {
    input_names: 'id'
    feature_type: IdFeature
    embedding_dim: 128
    hash_bucket_size: 100000
  }
}

model_config:{
  model_class: "ULTRAGCN"
  ultragcn {
    l2_regularization: 1e-6
    user_num: 52643
    item_num: 91599
    output_dim: 128
    nbr_num: 10
    neg_num: 10
    neg_weight: 10
    i2i_weight: 2.75
    l2_weight: 1e-4
  }
  loss_type: SOFTMAX_CROSS_ENTROPY
  embedding_regularization: 0.0
}

export_config {

}
